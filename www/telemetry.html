<!DOCTYPE HTML>
<!--
	Landed by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>ConduitNet Telemetry - Distributed Tracing & Observability</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<meta name="description" content="Learn how ConduitNet implements distributed tracing using System.Diagnostics.Activity and W3C Trace Context across WebSocket transports." />
		<meta name="keywords" content="ConduitNet, Telemetry, OpenTelemetry, Distributed Tracing, .NET 9, System.Diagnostics.Activity, W3C Trace Context" />

		<!-- Open Graph / Facebook -->
		<meta property="og:type" content="article" />
		<meta property="og:url" content="https://conduitnet.com/telemetry.html" />
		<meta property="og:title" content="ConduitNet Telemetry & Observability" />
		<meta property="og:description" content="End-to-end visibility into your distributed fabric with zero external dependencies in the core." />
		<meta property="og:image" content="https://conduitnet.com/images/conduit.png" />

		<!-- Twitter -->
		<meta property="twitter:card" content="summary_large_image" />
		<meta property="twitter:url" content="https://conduitnet.com/telemetry.html" />
		<meta property="twitter:title" content="ConduitNet Telemetry & Observability" />
		<meta property="twitter:description" content="End-to-end visibility into your distributed fabric with zero external dependencies in the core." />
		<meta property="twitter:image" content="https://conduitnet.com/images/conduit.png" />

        <!-- Syntax Highlighting (Prism) -->
        <link href="https://unpkg.com/prism-themes@1.9.0/themes/prism-vsc-dark-plus.min.css" rel="stylesheet" />
        <style>
            /* Force VS Code Dark Background */
            pre[class*="language-"], code[class*="language-"] {
                background-color: #1e1e1e !important;
                background-image: none !important;
                color: #d4d4d4 !important;
                text-shadow: none !important;
                border: none !important;
                box-shadow: none !important;
                font-family: Consolas, 'Courier New', monospace !important;
                font-size: 14px !important;
                /* Responsive wrapping */
                white-space: pre-wrap !important;
                word-wrap: break-word !important;
            }
            
            /* Adjust Line Numbers to match VS Code */
            .line-numbers .line-numbers-rows {
                border-right: 1px solid #404040 !important;
            }
        </style>
        <link href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.css" rel="stylesheet" />
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/components/prism-csharp.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/plugins/line-numbers/prism-line-numbers.min.js"></script>
        
        <!-- Mermaid Diagrams -->
        <script src="https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js"></script>
        <script>mermaid.initialize({startOnLoad:true, theme: 'dark'});</script>

		<script type="module" src="/src/telemetry.ts"></script>
	</head>
	<body class="is-preload left-sidebar">
		<div id="page-wrapper">

			<!-- Header -->
				<conduit-nav></conduit-nav>

			<!-- Hero -->
                <conduit-hero 
                    background-image="images/background10.png"
                    title="Distributed Observability" 
                    subtitle="Everything is a Node: Native Telemetry Collection"
                ></conduit-hero>

			<!-- Main Content -->
				<div id="main" class="wrapper style1">
					<div class="container">
						<header class="major">
							<h2>The "Everything is a Node" Philosophy</h2>
							<p>In ConduitNet, telemetry isn't a sidecar or a magical agent. It's just another service. The <strong>Telemetry Node</strong> is a first-class citizen in the mesh, receiving traces via standard Conduit RPC calls.</p>
						</header>

                        <div class="row gtr-150">
                            <div class="col-4 col-12-medium">
                                <conduit-sidebar></conduit-sidebar>
                            </div>
                            <div class="col-8 col-12-medium imp-medium">

                                <!-- Content -->
                                    <section>
                                        <h3>Architecture Overview</h3>
								<p>Instead of pushing data to an external HTTP endpoint directly, services in the mesh export their traces to a dedicated <code>ITelemetryCollector</code> service. This service runs on a standard Conduit Node.</p>
                                
                                <div class="mermaid">
                                    graph TD
                                    subgraph "Conduit Mesh"
                                        Dir[Directory Service]
                                        
                                        subgraph "User Node"
                                            US[User Service]
                                            Exp[Conduit Trace Exporter]
                                        end
                                        
                                        subgraph "Telemetry Node"
                                            TC[Telemetry Collector]
                                        end
                                        
                                        US -->|1. Register| Dir
                                        TC -->|1. Register| Dir
                                        
                                        US -- "2. RPC: GetUser" --> US
                                        Exp -- "3. RPC: ExportBatch" --> TC
                                    end
                                    
                                    TC -->|4. Forward| OTLP[OpenTelemetry Collector / Jaeger]
                                </div>

                                <hr />

                                <h3>1. The Telemetry Node</h3>
                                <p>The Telemetry Node is a standard Conduit application. It implements the <code>ITelemetryCollector</code> contract. This demonstrates the power of the "Everything is a Node" architecture: infrastructure concerns are implemented using the same primitives as business logic.</p>

                                <pre class="line-numbers"><code class="language-csharp">using ConduitNet.Node;
using ConduitNet.Contracts;

namespace ConduitNet.Telemetry.Node
{
    public class TelemetryNode : ConduitNode
    {
        public TelemetryNode(string[] args) : base(args) { }

        protected override void ConfigureServices(IServiceCollection services)
        {
            // Register the Telemetry Collector Service implementation
            // This makes it discoverable by the Directory
            RegisterConduitService&lt;ITelemetryCollector, TelemetryCollectorService&gt;();
        }

        protected override void Configure(WebApplication app)
        {
            // Expose the Conduit RPC endpoint over WebSockets
            app.MapConduitService&lt;ITelemetryCollector&gt;();
        }
    }
}</code></pre>

                                <h3>2. The Collector Service Implementation</h3>
                                <p>The service implementation receives batches of traces. It can then process them, log them, or forward them to an external system like Jaeger or Honeycomb.</p>

                                <pre class="line-numbers"><code class="language-csharp">public class TelemetryCollectorService : ITelemetryCollector
{
    public Task ExportBatchAsync(List&lt;ActivityExportDto&gt; batch)
    {
        Console.WriteLine($"[TelemetryCollector] Received batch of {batch.Count} spans");
        
        foreach (var span in batch)
        {
            Console.WriteLine($" - Trace: {span.TraceId} | Span: {span.SpanId} | Name: {span.DisplayName}");
        }
        
        return Task.CompletedTask;
    }
}</code></pre>

                                <hr />

                                <h3>3. Configuring Services to Emit Telemetry</h3>
                                <p>Any service in the mesh can be configured to send its traces to the Telemetry Node. We provide a custom <code>ConduitTraceExporter</code> that adapts OpenTelemetry's export pipeline to Conduit's RPC mechanism.</p>

                                <pre class="line-numbers"><code class="language-csharp">// In your Service's ConfigureServices method
protected override void ConfigureServices(IServiceCollection services)
{
    // 1. Register the Client for the Telemetry Collector
    // This allows this node to talk to the Telemetry Node via the Directory
    services.AddConduitClient&lt;ITelemetryCollector&gt;();

    // 2. Configure OpenTelemetry
    services.AddOpenTelemetry()
        .WithTracing(builder => builder
            .AddSource("ConduitNet") // Capture internal framework traces
            .SetResourceBuilder(ResourceBuilder.CreateDefault().AddService("MyService"))
            .AddProcessor(sp => 
            {
                // Resolve the RPC Client
                var collector = sp.GetRequiredService&lt;ITelemetryCollector&gt;();
                
                // Use the Batch Processor with our Custom RPC Exporter
                return new BatchActivityExportProcessor(
                    new ConduitTraceExporter(collector, "MyService")
                );
            }));
}</code></pre>

                                <h3>Why This Matters</h3>
                                <ul>
                                    <li><strong>Protocol Homogeneity:</strong> You don't need to open extra HTTP ports or manage sidecars for telemetry. It travels over the same WebSocket fabric as your application traffic.</li>
                                    <li><strong>Dynamic Discovery:</strong> If you move the Telemetry Node to a different server, the Directory automatically updates all services. No config changes required.</li>
                                    <li><strong>Resilience:</strong> Since it uses the standard Conduit Client, telemetry export benefits from the same retry policies, load balancing, and circuit breaking as your business logic.</li>
                                </ul>

							</section>

                            </div>
                        </div>

					</div>
				</div>

			<!-- Footer -->
                <conduit-footer></conduit-footer>

		</div>

		<!-- Scripts -->
			<!-- Scripts are handled by Vite modules -->

	</body>
</html>
